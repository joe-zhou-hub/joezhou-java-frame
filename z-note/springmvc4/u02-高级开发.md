# 1. 请求参数转换

**概念：** 处理器适配器中可配置自定义类型转换器，用于将请求参数类型转成自定义类型：
- 开发转换器类：实现 `o.s.c.c.c.Converter<A, B>` 接口并重写 `convert()`：
    - 该转换器仅在动作方法使用B类型变量接收A类型请求参数时生效。
- 配置转换器类：主配文件中管理 `o.s.f.s.FormattingConversionServiceFactoryBean`：
    - 注入 `converters`：使用 `<set>` + `<bean>` 注入1或N个转换器类全名。
    - 使用 `<mvc:annotation-driven />` 的 `conversion-service` 引用转换器类。
- 使用转换注解：主配文件中管理 `o.s.f.s.FormattingConversionServiceFactoryBean`：
    - 无需注入 `converters`，否则转换注解失效，仍使用转换器类方式。
    - 使用 `@DateTimeFormat(pattern="")` 标记动作方法参数或实体类属性。
    - 异常信息存放在 `BindingResult` 参数中，其位置必须紧跟爆发异常的那个实体类参数。

**源码：** /springmvc4/
- res: `spring/springmvc.xml`
- src: `c.j.converter.StringToDateConverter`
- src: `c.j.controller.ConverterController`
- psm: `/api/converter/string-to-date`
- psm: `/api/converter/date-time-format`

# 2. 请求参数校验

**概念：** HibernateValidator是JSR303的拓展校验工具，用于校验请求参数是否满足指定格式：
- 添加依赖 `hibernate-validator`。
- 主配中添加 `<mvc:annotation-driven />` 以驱动 `o.s.v.b.LocalValidatorFactoryBean` 校验类。
- 开发实体类：为属性标记HibernateValidator校验注解，多注解优先级从上到下：
    - `@Null`：所标记的属性必须为null。
    - `@NotNull`：所标记的属性必须不为null。
    - `@AssertTrue`：所标记的属性必须为true。
    - `@AssertFalse`：所标记的属性必须为false。
    - `@Min(18)`：所标记的属性必须是大于等于18的一个整数。
    - `@Max(18)`：所标记的属性必须是小于等于18的一个整数。
    - `@DecimalMin(3.5)`：所标记的属性必须是大于等于3.5的一个浮点数。
    - `@DecimalMax(3.5)`：所标记的属性必须是小于等于3.5的一个浮点数。
    - `@Size(2, 9)`：所标记的属性的必须是2到9之间的一个数。
    - `@Digits (integer, fraction)`：所标记的属性必须是一个数字，其值必须在可接受的范围内。
    - `@Past`：所标记的属性必须是一个过去的日期。
    - `@Future`：所标记的属性必须是一个将来的日期。
    - `@Pattern(value)`：所标记的属性必须符合指定的正则表达式。
    - `@Email`：所标记的属性必须是合法的电子邮箱地址，JSR303拓展注解。
    - `@Length`：所标记的字符串属性的长度必须在指定的范围内，JSR303拓展注解。
    - `@NotEmpty`：所标记的字符串，集合，数组等类型属性必须不为null且长度不为0，JSR303拓展注解。
    - `@Range`：所标记的属性值必须在指定的范围内，JSR303拓展注解。
- 开发动作类：对动作方法实体类参数标记 `@Valid` 以对其启用HibernateValidator校验。
    - 异常信息存放在 `BindingResult` 参数中，其位置必须紧跟爆发异常的那个实体类参数。

**源码：** /springmvc4/
- res: `spring/springmvc.xml`
- src: `c.j.pojo.Teacher`
- src: `c.j.valid.HibernateValidatorController`
- psm: `/api/valid/hibernate-validator`