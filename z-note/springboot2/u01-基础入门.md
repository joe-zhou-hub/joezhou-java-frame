# 1. 概念入门

**概念：** [springboot](https://spring.io/) 是由Pivotal团队提供的全新框架，用于简化项目搭建过程，开发过程和部署过程等，springboot项目独立运行，不依赖外部web容器，且对很多主流开发框架的无配置集成，就像maven整合了很多依赖一样，springboot整合了很多框架。

## 1.1 手动搭建

**流程：** 
- 新建maven-jar项目并添加springboot的 `<parent>`。
    - `<version>` 用于指定springboot版本，后续依赖根据该版本自动选择适合的版本，无需手配。
    - `<relativePath/>` 表示允许在maven仓库中可以查找到它。
- 引入依赖：`spring-boot-starter-web/spring-boot-starter-test/lombok` 等。
- 配置jdk编码和版本。
- 配置springboot的maven插件，若不打算用maven插件来运行应用则忽略。
- 开发启动类：类上标记 `@SpringBootApplication` 以开启自动配置。
- 开发动作类：必须位于启动类同级或下级，否则失效：
    - `@RestController` 组装了 `@Controller` 和 `@ResponseBody`。
- 启动项目：springboot内置tomcat，勿手动将项目部署到tomcat。
- 访问项目：一个tomcat只跑一个项目，访问路径中勿加项目名，直接访问路由即可。

**源码：** /springboot2-manual/
- res: `pom.xml`
- src: `c.j.s.App`
- src: `c.j.s.controller.StartController`
- psm: `http://127.0.0.1:8080/api/start/test`

## 1.2 自动搭建

**流程：** springboot项目可在 [官网](https://start.spring.io/) 自动搭建，或使用IDEA进行自动搭建：
- `New Project/Module` - `Spring Initializr` - `Next`。
- 填写项目横纵坐标，java版本，打包方式，启动类包名等元信息。
- 选择依赖，如 `Spring Web`，`Lombok`，`Spring Boot DevTools` 等。
- 目录结构：
    - `src/main/java`：存放源代码。
    - `src/main/resources/static`：存放静态文件，如css，js，image等，浏览器可直接访问。
    - `src/main/resources/templates`：存放页面文件，如jsp，html等。
    - `src/main/resources/application.properties`：springboot核心配置文件。
    - `.gitignore`：分布式版本控制系统git的配置文件，其中规定了哪些文件不提交，可删除。
    - `mvnw`：maven wrapper，用于在 `maven-wrapper.properties` 文件中记录你要使用的maven版本，当执行maven命令时发现当前maven版本和记录的期望版本不一致时会下载期望版本后再执行，可删除。
    - `.mvn`：存放 `maven-wrapper.properties` 和相关jar包的目录，可删除。
    - `mvn.cmd`：执行 `mvnw` 命令的cmd入口，可删除。
    - `HELP.md`：说明书和向导文件，可删除。

> springboot默认会顺序从 `/META-INF/resources`，`classpath:/resources/`，`classpath:/static/`，`classpath:/public/` 中寻找资源，有则直接返回，若都没有404。

**源码：** /springboot2/
- src: `c.j.controller.StartController`
- psm: `http://127.0.0.1:8080/api/start/test`

# 2. RestTemplate

**概念：** `RestTemplate` 是spring3开始支持的，用来模拟客户端向服务端发送请求的工具，继承自 `InterceptingHttpAccessor` 并实现 定义了常见的如GET，POST等请求操作 `RestOperations` 接口：
- 开发动作类：
    - `@GetMapping` 相当于 `@RequestMapping(method = RequestMethod.GET)`。
    - `@PostMapping` 相当于 `@RequestMapping(method = RequestMethod.POST)`。
- 开发测试类：使用 `new RestTemplate()` 实例化 `RestTemplate` 对象。
    - `getForEntity()`：使用GET方式发送请求，返回响应数据和响应头，状态码等额外信息。
    - `getForObject()`：使用GET方式发送请求，仅返回响应数据。
    - `postForObject()`：使用POST方式发送请求，仅返回响应数据。
    - `postForObject()`：使用POST方式发送请求，仅返回响应数据。

**源码：** /springboot2/
- src: `c.j.s.controller.RestTemplateController`
- tst: `c.j.s.RestTemplateTest`

# 3. 模拟POST请求

**概念：** RestTemplate对于POST请求提供了三个API方法：
- `getForEntity()`：获取响应数据和响应头/状态码等额外信息。
- `getForObject()`：只获取预期的响应式数据。
- `forLocation()`：获取响应路径，需要三个注意点：
    - 测试的动作类方法不能添加 `@ResponseBody`，需要让其跳页。
    - 测试的动作类方法的返回值必须使用 `redirect:/success.html` 格式，且 `/` 不能省略，否则获取不到路径。
    - 在 `classpath:public` 文件夹下新建 `success.html` 文件，这个文件夹是默认静态资源访问位置之一。

**源码：** RestTemplateTest.java 中添加
```java
@Test
void byPostWithNoParam() {
    String url = "http://127.0.0.1:8080/api/start/hello.action";
    String result = restTemplate.postForObject(url, null, String.class);
    System.out.println(result);
}

@Test
void byPostWithParam() {
    MultiValueMap<String, String> request = new LinkedMultiValueMap<>();
    request.add("name", "joe");
    String url = "http://127.0.0.1:8080/api/start/by-post-with-param.action";
    String result = restTemplate.postForObject(url, request, String.class);
    System.out.println(result);
}

@Test
void byPostForLocation() {
    String url = "http://localhost:8080/api/start/by-post-for-location.action";
    URI uri = restTemplate.postForLocation(url,null);
    System.out.println(uri);
}

```

> post方法可以和get方法混用。




    - springboot的动作方法可以对直接返回的 `String/List/Map/Pojo/数组` 等类型直接进行JSON转化。
