# 1. 整合准备

**流程：**
- 添加依赖：
    - `mybatis`：mybatis/mysql-connector-java/commons-dbcp2
    - `spring`：spring-core/beans/aspects/tx/jdbc
    - `spring`：spring-context/context-support/expression
    - `log`：log4j-core/log4j/slf4j-api/slf4j-log4j12
    - `mybatis-spring`：mybatis-spring
    - `other`：lombok/junit/spring-test
- 开发实体类。
- 开发mybatis主配文件：只配置别名，SQL配置文件扫描和数据源交给spring做。

**源码：** /mybatis3/
- res: `pom.xml`
- res: `classpath:mybatis-sm.xml`
- src: `c.j.pojo.Dog`

# 2. 原生DAO整合

**流程：** 原生DAO不使用接口方式开发：
- 开发SQL配置文件：编写 `<insert>` 语句块。
- 开发数据层接口和实现类：继承 `SqlSessionDaoSupport`：
    - `getSqlSession()`：获取一个自主管理事务和关闭的session对象，不支持手动管理。
- spring主配文件中加载属性文件：
    - `<context:property-placeholder location="classpath:属性文件位置">`
- spring主配文件中管理数据源：
    - IOC：`<bean id="dataSource" class="o.a.c.d.BasicDataSource">`。
    - DI数据源的驱动串，连接串，账号密码等信息。
- spring主配文件中管理会话工厂：
    - IOC：`<bean id="factory" class="o.m.s.SqlSessionFactoryBean">`
    - 将mybatis的主配文件DI到 `configLocation` 属性。
    - 将数据源DI到 `dataSource` 属性。
    - 将mybatis的SQL配置文件DI到 `mapperLocations` 属性。
- spring主配中管理 `DogDaoImpl`：
    - IOC：`<bean class="c.j.dao.DogDaoImpl">`
    - 将会话工厂DI到 `sqlSessionFactory` 属性（其父类的SET方法）。

**源码：** /mybatis3/
- res: `c.j.mapper.DogMapper.xml`
- res: `classpath:mybatis-sm.xml`
- res: `classpath:sprint/spring-sm.xml`
- src: `c.j.pojo.Dog`
- tst: `c.j.sm.DogTest`